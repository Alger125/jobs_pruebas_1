# ARCHIVO: com/apress/springbatch/chapter2/lib/imp/sql-GCLIENTES.properties

# 1. Reader - Filtra por saldo minimo
SQL_LISTAR_CLIENTES_CON_SALDO=\
SELECT \
    c.cliente_id, \
    c.nombre, \
    c.apellido, \
    c.segmento, \
    cu.saldo \
FROM CLIENTES_BBVA c \
INNER JOIN CUENTAS_BBVA cu ON c.cliente_id = cu.cliente_id \
WHERE cu.saldo > ?

# 2. Detalle
SQL_GET_DETALLE_MOVIMIENTO=\
SELECT \
tipo, \
monto, \
fecha \
FROM MOVIMIENTOS_BBVA \
WHERE cliente_id = ?

# 3. Ultimo Movimiento
SQL_GET_ULTIMO_MOVIMIENTO=\
SELECT \
    tipo, \
    monto, \
    fecha \
FROM MOVIMIENTOS_BBVA \
WHERE cliente_id = ? \
ORDER BY fecha DESC \
FETCH FIRST 1 ROWS ONLY

# 4. Resumen de Movimientos por Cliente
SQL_GET_RESUMEN_MOVIMIENTOS=\
SELECT \
    COUNT(*) AS total_operaciones, \
    SUM(monto) AS suma_total, \
    AVG(monto) AS promedio_monto \
FROM MOVIMIENTOS_BBVA \
WHERE cliente_id = ? \
GROUP BY cliente_id

# 4. Auditoria (Asegurate que existan la tabla y la secuencia)
SQL_INSERT_EVENTO=INSERT INTO BATCH_LOG (ID, JOB_NAME, STATUS, ODATE) \
VALUES (SEQ_BATCH_LOG.NEXTVAL, ?, ?, ?)